function initMap(){"use strict";map=new google.maps.Map(document.getElementById("map-area"),{center:{lat:32.7767,lng:-96.797},mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0});var e=new google.maps.InfoWindow,t=new google.maps.LatLngBounds,a=function(e){this.title=e.title,this.address=e.address,this.lat=e.lat,this.lng=e.lng,this.position=new google.maps.LatLng(this.lat,this.lng),this.marker=new google.maps.Marker({position:this.position,map:map,title:this.title,animation:google.maps.Animation.DROP})},o=function(){var o=this;o.shopList=ko.observableArray([]),o.filterList=ko.observableArray([]),o.query=ko.observable("");var i=window.matchMedia("(max-width: 700px)");i.matches?o.showSidelist=ko.observable(!1):o.showSidelist=ko.observable(!0),o.showmobilepanel=ko.observable(!1),o.detailmb=ko.observable(""),o.closeNav=function(){o.showSidelist(!1)},o.openNav=function(){o.showSidelist(!0)};var s=function(){shopDatabase.forEach(function(e){o.shopList.push(new a(e))})},n=function(){o.shopList().forEach(function(e){t.extend(e.position),e.marker.addListener("click",function(){o.showStoreInfo(e)})})},r=function(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.setAnimation(null)},700))};o.showStoreInfo=function(t){r(t.marker),map.setCenter(t.position),map.setZoom(15);var a='<div><h4 id="store-name">'+t.title+"</h4><p>Address: "+t.address+'</p><p><a target="_blank" id="yelp-url">yelp </a>: <span id="rating"></span> <img id="yelp"> <span id="reviews"></span></p><p>Phone: <span id="phone"></span></p></div>',i=window.matchMedia("(max-width: 700px)");i.matches?(o.showmobilepanel(!0),o.detailmb(""),o.detailmb(a),o.closeNav()):(e.setContent(a),e.open(map,t.marker)),l(t)},o.search=function(e){o.filterList([]);for(var a in o.shopList()){var i=o.shopList()[a],s=i.title.toLowerCase();s.indexOf(e.toLowerCase())>=0?(o.filterList.push(o.shopList()[a]),i.marker.setMap(map),t.extend(i.position),map.fitBounds(t)):i.marker.setMap(null)}$("#search").keypress(function(e){13==e.which&&o.showStoreInfo(o.filterList()[0])})};var l=function(e){var t="https://api.yelp.com/v2/search/",a=function(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<e;o++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},o={oauth_consumer_key:"FBk0ZuP0PRBTekezNCM7xA",oauth_token:"Ix8AXGdC8aLnJQjnXTblYit7i64UnKzt",oauth_nonce:a(20),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",term:e.title,location:"Dallas, tx",limit:1},i="X12-e9Q1AsLvNKGDpjKgMTZ4ep8",s="0sPuxJzhbHOK8YVc2iAdgih6v5A",n=oauthSignature.generate("GET",t,o,i,s);o.oauth_signature=n;var r={url:t,data:o,cache:!0,dataType:"jsonp",success:function(e){$("#yelp").attr("src",e.businesses[0].rating_img_url),$("#yelp-url").attr("href",e.businesses[0].url),$("#rating").text(e.businesses[0].rating+"/5"),$("#reviews").text(e.businesses[0].review_count+" reviews"),$("#phone").text(e.businesses[0].display_phone)},error:function(){$("#yelp").html("Error: No DATA.")}};$.ajax(r)};google.maps.event.addDomListener(window,"load",function(){s(),n(),o.filterList(o.shopList()),o.query.subscribe(o.search),map.fitBounds(t)})};ko.applyBindings(new o)}var map;