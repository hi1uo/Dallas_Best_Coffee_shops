function initMap(){"use strict";map=new google.maps.Map(document.getElementById("map-area"),{center:{lat:32.7767,lng:-96.797},mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0});var e=new google.maps.InfoWindow,t=new google.maps.LatLngBounds,o=function(e){this.title=e.title,this.address=e.address,this.lat=e.lat,this.lng=e.lng,this.position=new google.maps.LatLng(this.lat,this.lng),this.marker=new google.maps.Marker({position:this.position,map:map,title:this.title,animation:google.maps.Animation.DROP})},a=function(){var a,n=this;n.shopList=ko.observableArray([]),n.filterList=ko.observableArray([]),n.query=ko.observable(""),n.showmobilepanel=ko.observable(!1),n.shopDetailMobil=ko.observable("");var s=window.matchMedia("(max-width: 700px)");s.matches?n.showSidelist=ko.observable(!1):n.showSidelist=ko.observable(!0),n.closeNav=function(){n.showSidelist(!1)},n.openNav=function(){n.showSidelist(!0)};var r=function(){shopDatabase.forEach(function(e){n.shopList.push(new o(e))})},l=function(){n.shopList().forEach(function(e){t.extend(e.position),e.marker.addListener("click",function(){n.showStoreInfo(e)})})},p=function(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.setAnimation(null)},700))};n.yelURL=ko.observable(""),n.showStoreInfo=function(e){p(e.marker),map.setCenter(e.position),map.setZoom(15);var t='<h4 id="store-name">'+e.title+"</h4>",o="<p>Address: <span>"+e.address+"</span></p>";a=t+o,u(e),h(e,a)};var h=function(t,o){var a=window.matchMedia("(max-width: 700px)");a.matches?(n.showmobilepanel(!0),n.closeNav(),n.shopDetailMobil(""),n.shopDetailMobil(o)):(e.setContent(o),e.open(map,t.marker))};n.search=function(e){n.filterList([]),n.shopList().forEach(function(o){var a=o.title.toLowerCase();a.indexOf(e.toLowerCase())>=0?(n.filterList.push(n.shopList()[i]),o.marker.SetVisible(!0),t.extend(o.position),map.fitBounds(t)):o.marker.SetVisible(!1)}),$("#search").keypress(function(e){13==e.which&&n.showStoreInfo(n.filterList()[0])})};var u=function(e){var t="https://api.yelp.com/v2/search/",o=function(e){for(var t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=o.charAt(Math.floor(Math.random()*o.length));return t},i={oauth_consumer_key:"FBk0ZuP0PRBTekezNCM7xA",oauth_token:"Ix8AXGdC8aLnJQjnXTblYit7i64UnKzt",oauth_nonce:o(20),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",term:e.title,location:"Dallas, tx",limit:1},n="X12-e9Q1AsLvNKGDpjKgMTZ4ep8",s="0sPuxJzhbHOK8YVc2iAdgih6v5A",r=oauthSignature.generate("GET",t,i,n,s);i.oauth_signature=r;var l={url:t,data:i,cache:!0,dataType:"jsonp"};$.ajax(l).done(function(t){var o='<a target="_blank" id="yelp-url" href="'+t.businesses[0].url+'">yelp:</a>',i='<span id="rating">'+t.businesses[0].rating+"/5 </span>",n='<img id="rating-img" src ="'+t.businesses[0].rating_img_url+'">',s='<span id="reviews">'+t.businesses[0].review_count+" reviews</span>";a+=o+i+n+s,h(e,a)}).fail(function(){alert("No Yelp Data")})};google.maps.event.addDomListener(window,"load",function(){r(),l(),n.filterList(n.shopList()),n.query.subscribe(n.search),map.fitBounds(t)})};ko.applyBindings(new a)}function googleError(){"use strict";alert("Oops! Cannot load the map")}var map;