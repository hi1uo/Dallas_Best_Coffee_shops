function initMap(){"use strict";map=new google.maps.Map(document.getElementById("map-area"),{center:{lat:32.7767,lng:-96.797},mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0});var e=new google.maps.InfoWindow,t=new google.maps.LatLngBounds,o=function(e){this.title=e.title,this.address=e.address,this.lat=e.lat,this.lng=e.lng,this.position=new google.maps.LatLng(this.lat,this.lng),this.marker=new google.maps.Marker({position:this.position,map:map,title:this.title,animation:google.maps.Animation.DROP})},a=function(){var a=this;a.shopList=ko.observableArray([]),a.filterList=ko.observableArray([]),a.query=ko.observable(""),a.showmobilepanel=ko.observable(!1),a.shopDetailMobil=ko.observable("");var i=window.matchMedia("(max-width: 700px)");i.matches?a.showSidelist=ko.observable(!1):a.showSidelist=ko.observable(!0),a.closeNav=function(){a.showSidelist(!1),a.showmobilepanel(!0)},a.openNav=function(){a.showSidelist(!0),a.showmobilepanel(!1)};var n,s=function(){shopDatabase.forEach(function(e){a.shopList.push(new o(e))})},r=function(){a.shopList().forEach(function(e){t.extend(e.position),e.marker.addListener("click",function(){a.showStoreInfo(e)})})},l=function(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.setAnimation(null)},700))};a.showStoreInfo=function(e){l(e.marker),map.setCenter(e.position),map.setZoom(15);var t='<h4 id="store-name">'+e.title+"</h4>",o="<p>Address: <span>"+e.address+"</span></p>";n=t+o,h(e),p(e,n)};var p=function(t,o){var i=window.matchMedia("(max-width: 700px)");i.matches?(a.showmobilepanel(!0),a.closeNav(),a.shopDetailMobil(""),a.shopDetailMobil(o)):(e.setContent(o),e.open(map,t.marker))};a.search=function(e){a.filterList([]),a.shopList().forEach(function(o){var i=o.title.toLowerCase();i.indexOf(e.toLowerCase())>=0?(a.filterList.push(o),o.marker.setVisible(!0),t.extend(o.position),map.fitBounds(t)):o.marker.setVisible(!1)}),$("#search").keypress(function(e){13==e.which&&a.showStoreInfo(a.filterList()[0])})};var h=function(e){var t="https://api.yelp.com/v2/search/",o=function(e){for(var t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=o.charAt(Math.floor(Math.random()*o.length));return t},a={oauth_consumer_key:"FBk0ZuP0PRBTekezNCM7xA",oauth_token:"Ix8AXGdC8aLnJQjnXTblYit7i64UnKzt",oauth_nonce:o(20),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",term:e.title,location:"Dallas, tx",limit:1},i="X12-e9Q1AsLvNKGDpjKgMTZ4ep8",s="0sPuxJzhbHOK8YVc2iAdgih6v5A",r=oauthSignature.generate("GET",t,a,i,s);a.oauth_signature=r;var l={url:t,data:a,cache:!0,dataType:"jsonp"};$.ajax(l).done(function(t){var o='<a target="_blank" id="yelp-url" href="'+t.businesses[0].url+'">yelp:</a>',a='<span id="rating">'+t.businesses[0].rating+"/5 </span>",i='<img id="rating-img" src ="'+t.businesses[0].rating_img_url+'">',s='<span id="reviews">'+t.businesses[0].review_count+" reviews</span>",r="<p>Phone: "+t.businesses[0].display_phone+"</p>";n+="<p>"+o+a+i+s+r+"</p>",p(e,n)}).fail(function(){alert("No Yelp Data")})};google.maps.event.addDomListener(window,"load",function(){s(),r(),a.filterList(a.shopList()),a.query.subscribe(a.search),map.fitBounds(t)})};ko.applyBindings(new a)}function googleError(){"use strict";alert("Oops! Cannot load the map")}var map;